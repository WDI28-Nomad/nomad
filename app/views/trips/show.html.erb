<div class="col-sm-3">
  <!-- When rendering a partial from another folder, you dont need the underscore in the name of the partial -->
  <div class="row sidebar">
  <%= render "/users/sidebar" %>
  </div>
  <br>
  <div class="row">
  <%= render "/users/my_trips" %>
  </div>
</div>
<div class="col-sm-9">
  <h1 class="page-title"><%= @trip.name %></h1>

  <!-- Placeholder for budget bar -->
  <div class="panel-footer"><h1>budget-bar</h1></div>

  <h4>Type: <%= @trip.trip_type %></h4>
  <h4>Budget: <%= @trip.budget %></h4>
  <h4>Origin: <%= @trip.origin %></h4>
  <h4>Destination: <%= @trip.destination %></h4>

  <% if current_user %>
    <%= link_to "", edit_user_trip_path(@user, @trip), class: "glyphicon glyphicon-pencil" %>
    <%= link_to "", user_trip_path(@user, @trip), method: :delete, data: {confirm: "Are you sure you want to delete this trip?"}, class: "glyphicon glyphicon-trash" %>
  <% end %>
  <br>
  <hr>

  <%= link_to "Back to My Trips", user_path(@user), class: "btn btn-primary" %>

  <div class="add-expense-button" role="button" data-toggle="collapse" href="#collapseExample" aria-expanded="false">
    <span class = "btn btn-primary btn-lg add-expense-button">Add Expense</span> 
  </div>

  <div class="collapse" id="collapseExample">
    <%= render 'expenses/form' %>
  </div>

  <div class="col-sm-8 col-sm-offset-2">
    <table>
      <tr class="expense-header-row">
        <td class="expense-table-header">Name</td>
        <td class="expense-table-header">Expense Type</td>
        <td class="expense-table-header">Amount</td>
        <td class="expense-table-header"></td>
      </tr>
      <% @expenses.each do |e| %>
      <tr class="expense-row">
        <td class="expense-table"><%= e.name %></td>
        <td class="expense-table"><%= e.expense_type %></td>
        <td class="expense-table"><%= click_to_edit e, path: user_trip_expense_path(@user, @trip, e), attribute: :amount, deletable: true %></td>
        <td class="expense-table">
           <%= link_to "", user_trip_expense_path(@user, @trip, e),
           method: :delete,
           data: {confirm: "Are you sure you want to delete #{e.name}?"},
           class: "glyphicon glyphicon-trash pull-right" %>
           <%= link_to "", edit_user_trip_expense_path(@user, @trip, e), class: "glyphicon glyphicon-pencil pull-right" %></td>
      </tr>
      <tr>
        <% if e.expense_type == "Airfare" %>
          <td>
            <a href="http://www.kayak.com/flights" target="_blank">Find Flights</a>
          </td>
        <% elsif e.expense_type == "Lodging" %>
          <!-- Add the Origin City to the URL -->
          <td>
            <a href="https://www.kayak.com/hotels" target="_blank">Search Hotels</a> |
            <a href="https://www.airbnb.com" target="_blank">Airbnb</a>
          </td>
        <% end %>
      </tr>
      <% end %>
    </table>
    <br>
  </div>
</div>
